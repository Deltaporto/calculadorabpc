<!DOCTYPE html>
<html lang="pt-BR">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Calculadora Biopsicossocial — BPC/LOAS</title>
  <meta name="description" content="Calculadora interativa para avaliação biopsicossocial do BPC">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link
    href="https://fonts.googleapis.com/css2?family=DM+Sans:opsz,wght@9..40,400;9..40,500;9..40,600;9..40,700&family=Source+Sans+3:wght@300;400;600;700&display=swap"
    rel="stylesheet">
  <link rel="icon" href="data:,">
  <link rel="stylesheet" href="src/styles/main.css">
</head>

<body>
  <div class="app">
    <a href="#judicialControlSection" class="skip-link">Pular para o Controle Judicial</a>
    <svg class="icon-sprite" aria-hidden="true">
      <symbol id="i-balance" viewBox="0 0 24 24">
        <path d="M4 7h16" />
        <path d="M12 7v10" />
        <path d="M8 17h8" />
        <path d="M5 7 2.5 11h5z" />
        <path d="M19 7 16.5 11h5z" />
        <path d="M2.5 11c0 1.7 1.3 3 3 3s3-1.3 3-3" />
        <path d="M16.5 11c0 1.7 1.3 3 3 3s3-1.3 3-3" />
      </symbol>
      <symbol id="i-moon" viewBox="0 0 24 24">
        <path d="M20 14.5A8 8 0 1 1 9.5 4 6.5 6.5 0 0 0 20 14.5z" />
      </symbol>
      <symbol id="i-child" viewBox="0 0 24 24">
        <rect x="2.5" y="5.5" width="19" height="13" rx="2" />
        <circle cx="8.5" cy="11.2" r="1.8" />
        <path d="M5.9 15.4c.6-1.4 1.5-2.1 2.6-2.1s2 .7 2.6 2.1" />
        <path d="M14 10h4.5" />
        <path d="M14 13h4.5" />
      </symbol>
      <symbol id="i-chart" viewBox="0 0 24 24">
        <path d="M4 20h16" />
        <rect x="5" y="12" width="3" height="6" rx="1" />
        <rect x="10.5" y="9" width="3" height="9" rx="1" />
        <rect x="16" y="6" width="3" height="12" rx="1" />
      </symbol>
      <symbol id="i-trash" viewBox="0 0 24 24">
        <path d="M4 7h16" />
        <path d="M9 7V5h6v2" />
        <path d="M7 7l1 12h8l1-12" />
        <path d="M10 10v6" />
        <path d="M14 10v6" />
      </symbol>
      <symbol id="i-alert" viewBox="0 0 24 24">
        <path d="M12 3 2.8 19h18.4L12 3z" />
        <path d="M12 9v4" />
        <circle cx="12" cy="15.2" r=".9" fill="currentColor" stroke="none" />
      </symbol>
      <symbol id="i-home" viewBox="0 0 24 24">
        <path d="M3.5 10.5 12 4l8.5 6.5" />
        <path d="M5 9.8V20h14V9.8" />
        <path d="M10 20v-5h4v5" />
      </symbol>
      <symbol id="i-stethoscope" viewBox="0 0 24 24">
        <path d="M7 4v5a3 3 0 0 0 6 0V4" />
        <path d="M7 6h6" />
        <path d="M13 10v3a4 4 0 0 0 8 0v-2" />
        <circle cx="21" cy="10.5" r="1.5" />
      </symbol>
      <symbol id="i-network" viewBox="0 0 24 24">
        <circle cx="6" cy="12" r="2" />
        <circle cx="18" cy="7" r="2" />
        <circle cx="18" cy="17" r="2" />
        <path d="M8 12h5" />
        <path d="M13 12 16.2 8.8" />
        <path d="M13 12 16.2 15.2" />
      </symbol>
      <symbol id="i-save" viewBox="0 0 24 24">
        <path d="M5 4h11l3 3v13H5z" />
        <path d="M8 4v6h8V6.5L13.5 4z" />
        <rect x="8" y="14" width="8" height="5" rx="1" />
      </symbol>
      <symbol id="i-document" viewBox="0 0 24 24">
        <path d="M7 3h7l4 4v14H7z" />
        <path d="M14 3v4h4" />
        <path d="M10 12h6" />
        <path d="M10 15h6" />
      </symbol>
      <symbol id="i-close" viewBox="0 0 24 24">
        <path d="M6 6 18 18" />
        <path d="M18 6 6 18" />
      </symbol>
      <symbol id="i-clipboard" viewBox="0 0 24 24">
        <rect x="6" y="5" width="12" height="16" rx="2" />
        <path d="M9 5.5h6V4a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1z" />
        <path d="M9 10h6" />
        <path d="M9 13h6" />
      </symbol>
      <symbol id="i-check-circle" viewBox="0 0 24 24">
        <circle cx="12" cy="12" r="9" />
        <path d="m8 12 2.6 2.7L16.5 9" />
      </symbol>
      <symbol id="i-x-circle" viewBox="0 0 24 24">
        <circle cx="12" cy="12" r="9" />
        <path d="m9 9 6 6" />
        <path d="m15 9-6 6" />
      </symbol>
      <symbol id="i-swap" viewBox="0 0 24 24">
        <path d="M4 8h11" />
        <path d="m12 5 3 3-3 3" />
        <path d="M20 16H9" />
        <path d="m12 13-3 3 3 3" />
      </symbol>
    </svg>
    <header>
      <span class="badge"><svg class="ui-icon sm" aria-hidden="true">
          <use href="#i-balance"></use>
        </svg>BPC / LOAS</span>
      <h1>Calculadora Biopsicossocial</h1>
      <p><a class="header-portaria-link" id="headerPortariaPdfLink" href="docs/normas/portaria-conjunta-2-2015.pdf"
          target="_blank" rel="noopener noreferrer"
          title="Abrir o PDF da Portaria Conjunta MDS/INSS nº 2/2015 em nova aba">Portaria Conjunta MDS/INSS nº
          2/2015</a></p>
      <div class="app-mode-switch" id="modeSwitcher" role="group" aria-label="Modo da aplicação">
        <button class="mode-btn" data-mode="controle">Controle Judicial</button>
        <button class="mode-btn" data-mode="simulador">Simulador</button>
      </div>
      <div class="header-row">
        <label><input type="checkbox" id="toggleDark"><svg class="ui-icon sm" aria-hidden="true">
            <use href="#i-moon"></use>
          </svg>Modo escuro</label>
        <label><input type="checkbox" id="toggleMenor16"><svg class="ui-icon sm" aria-hidden="true">
            <use href="#i-child"></use>
          </svg>Idade inferior a 16 anos</label>
        <span class="idade-input hidden" id="idadeWrap">
          <label for="inputIdade">Idade:</label>
          <input type="number" id="inputIdade" min="0" max="15" step="1" value="15" inputmode="numeric">
          <select id="inputIdadeUnidade" aria-label="Unidade de tempo">
            <option value="anos" selected>anos</option>
            <option value="meses">meses</option>
          </select>
          <strong id="faixaEtaria" class="idade-status"></strong>
        </span>
        <span class="idade-status hidden" id="childAutoSummary"></span>
      </div>
    </header>

    <details id="simuladorDetails" class="simulador-details" open>
      <summary class="simulador-summary">Calculadora (consulta rápida)</summary>
      <div class="simulador-body">
        <div class="toolbar">
          <button class="btn btn-gold" id="btnPadrao"
            title="Preenche o padrão médio social. Se houver conflito com preenchimento manual, você escolhe na hora."><svg
              class="ui-icon sm" aria-hidden="true">
              <use href="#i-chart"></use>
            </svg>Aplicar padrão médio</button>
          <button type="button" class="sim-help-btn section-help-btn toolbar-help-btn" id="btnPadraoHelp"
            data-help-key="section.padrao_medio" aria-label="Entender o que é o padrão médio social"
            aria-controls="simHelpPopover" aria-expanded="false">i</button>
          <button class="btn btn-outline" id="btnLimpar"
            title="Limpa todos os domínios e redefine as opções da simulação."><svg class="ui-icon sm" aria-hidden="true">
              <use href="#i-trash"></use>
            </svg>Limpar tudo</button>
          <div class="toolbar-toggle-group">
            <label class="toggle-label">
              <input type="checkbox" id="toggleImpedimento"><span class="toggle-switch"></span><svg class="ui-icon sm"
                aria-hidden="true">
                <use href="#i-alert"></use>
              </svg>
              Impedimento &lt; 2 anos
            </label>
            <button type="button" class="sim-help-btn section-help-btn toolbar-help-btn" id="btnImpedimentoHelp"
              data-help-key="concept.impedimento_lp" aria-label="Entender o conceito de impedimento de longo prazo"
              aria-controls="simHelpPopover" aria-expanded="false">i</button>
          </div>
        </div>
        <p class="toolbar-helper"><code>Aplicar padrão médio</code> aplica os domínios recomendados do perfil social
          médio. Se já houver preenchimento manual, você escolhe no momento entre preservar ou sobrescrever.</p>

        <main class="calculator">
          <!-- Panel Ambiente -->
          <section class="panel" style="--panel-color:#2563EB">
            <div class="panel-header">
              <div class="panel-icon"><svg class="ui-icon" aria-hidden="true">
                  <use href="#i-home"></use>
                </svg></div>
              <div>
                <h2>Fatores Ambientais <button type="button" class="sim-help-btn section-help-btn" data-help-key="section.ambiente"
                    aria-label="Entender o conceito de Fatores Ambientais" aria-controls="simHelpPopover"
                    aria-expanded="false">i</button></h2>
                <div class="sub">Avaliação Social · 5 domínios (e1–e5)</div>
              </div>
            </div>
            <div class="domains" id="domAmb"></div>
            <div class="panel-result">
              <div class="formula" id="fAmb"></div>
              <div class="result-bar">
                <div class="result-fill" id="barAmb"></div>
              </div>
              <div class="panel-result-row"><span class="qual-name" id="nameAmb">Nenhuma Barreira</span>
                <div class="qualifier-badge" id="qAmb" data-q="N">N</div>
              </div>
            </div>
          </section>
          <!-- Panel Atividades -->
          <section class="panel" style="--panel-color:#7C3AED">
            <div class="panel-header">
              <div class="panel-icon"><svg class="ui-icon" aria-hidden="true">
                  <use href="#i-network"></use>
                </svg></div>
              <div>
                <h2>Atividades e Participação <button type="button" class="sim-help-btn section-help-btn" data-help-key="section.atividades"
                    aria-label="Entender o conceito de Atividades e Participação" aria-controls="simHelpPopover"
                    aria-expanded="false">i</button></h2>
                <div class="sub">Misto · 9 domínios (d1–d9)</div>
              </div>
            </div>
            <div class="domains">
              <div class="section-label"><span class="badge-m">Perito Médico</span> d1–d5</div>
              <div id="domAtivM"></div>
              <div class="section-label"><span class="badge-s">Assistente Social</span> d6–d9</div>
              <div id="domAtivS"></div>
            </div>
            <div class="panel-result">
              <div class="formula" id="fAtiv"></div>
              <div class="result-bar">
                <div class="result-fill" id="barAtiv"></div>
              </div>
              <div class="panel-result-row"><span class="qual-name" id="nameAtiv">Nenhuma Dificuldade</span>
                <div class="qualifier-badge" id="qAtiv" data-q="N">N</div>
              </div>
            </div>
          </section>
          <!-- Panel Corpo -->
          <section class="panel" style="--panel-color:#DC2626">
            <div class="panel-header">
              <div class="panel-icon"><svg class="ui-icon" aria-hidden="true">
                  <use href="#i-stethoscope"></use>
                </svg></div>
              <div>
                <h2>Funções do Corpo <button type="button" class="sim-help-btn section-help-btn" data-help-key="section.corpo"
                    aria-label="Entender o conceito de Funções do Corpo" aria-controls="simHelpPopover"
                    aria-expanded="false">i</button></h2>
                <div class="sub">Avaliação Médica · 8 domínios (b1–b8)</div>
              </div>
            </div>
            <div class="domains" id="domCorpo"></div>
            <div class="majoracao-toggles">
              <label class="toggle-label"><input type="checkbox" id="toggleProg"><span
                  class="toggle-switch"></span>Prognóstico desfavorável</label>
              <label class="toggle-label"><input type="checkbox" id="toggleEstr"><span
                  class="toggle-switch"></span>Estrutura do Corpo &gt; Função</label>
            </div>
            <div class="panel-result">
              <div class="formula" id="fCorpo"></div>
              <div class="panel-result-row"><span class="qual-name" id="nameCorpo">Nenhuma Alteração</span>
                <div class="qualifier-badge" id="qCorpo" data-q="N">N</div>
              </div>
            </div>
          </section>
        </main>

        <section class="resultado" id="resultado">
          <h2>Resultado da Avaliação</h2>
          <div class="qualifiers-row">
            <div class="qual-card"><span class="qual-label">Fatores Ambientais</span>
              <div class="qualifier-badge large" id="rAmb" data-q="N">N</div><span class="qual-desc"
                id="dAmb">Nenhuma</span>
            </div>
            <span class="qual-sep">×</span>
            <div class="qual-card"><span class="qual-label">Atividades e Participação</span>
              <div class="qualifier-badge large" id="rAtiv" data-q="N">N</div><span class="qual-desc"
                id="dAtiv">Nenhuma</span>
            </div>
            <span class="qual-sep">×</span>
            <div class="qual-card"><span class="qual-label">Funções do Corpo</span>
              <div class="qualifier-badge large" id="rCorpo" data-q="N">N</div><span class="qual-desc"
                id="dCorpo">Nenhuma</span>
            </div>
          </div>
          <div class="tabela-section">
            <h3>Tabela Conclusiva — Anexo IV, Portaria 2/2015</h3>
            <div class="amb-tabs" role="group" aria-label="Fatores Ambientais"><span class="amb-tab-label">Fatores Ambientais:</span><button class="amb-tab active"
                data-a="0">N</button><button class="amb-tab" data-a="1">L</button><button class="amb-tab"
                data-a="2">M</button><button class="amb-tab" data-a="3">G</button><button class="amb-tab"
                data-a="4">C</button></div>
            <div class="tabela-matrix">
              <div class="tabela-axis-top"><span class="axis-kicker">Eixo horizontal</span><span
                  class="axis-title">Atividades e Participação (d1-d9)</span><span class="axis-arrow"
                  aria-hidden="true">→</span></div>
              <div class="tabela-axis-left"><span class="axis-arrow" aria-hidden="true">↓</span><span
                  class="axis-kicker">Eixo vertical</span><span class="axis-title">Funções do Corpo (b1-b8)</span></div>
              <div class="tabela-grid" id="tGrid"></div>
            </div>
            <p class="tabela-impact-note"><strong>Leitura prática:</strong> na matriz, Fatores Ambientais costuma ser
              decisivo sobretudo no cenário M×M (Funções do Corpo e Atividades em moderada). Fora desse ponto, moradia
              modesta porém funcional não implica, por si só, indeferimento.</p>
            <div class="tabela-labels"><span><span class="dot g"></span> Deferido (Sim)</span><span><span
                  class="dot r"></span> Indeferido (Não)</span></div>
            <p class="tabela-sensitivity-legend"><span class="dot-sensitivity" aria-hidden="true"></span> Realce
              discreto: ponto em que a variação de Fatores Ambientais altera o resultado.</p>
          </div>
          <div class="decision indeferido" id="decision">
            <div class="decision-icon" id="decIcon"><svg class="ui-icon lg" aria-hidden="true">
                <use href="#i-alert"></use>
              </svg></div>
            <div class="decision-label" id="decLabel">AGUARDANDO DADOS</div>
            <span class="decision-reason" id="decReason">Insira as notas nos domínios acima</span>
            <span class="decision-item" id="decItem"></span>
          </div>
        </section>
      </div>
    </details>

    <div class="footer-actions">
      <button class="btn btn-gold" id="btnLevarParaControle"><svg class="ui-icon sm" aria-hidden="true">
          <use href="#i-balance"></use>
        </svg>Levar cenário para Controle Judicial</button>
      <button class="btn btn-red hidden" id="btnClearComp"><svg class="ui-icon sm" aria-hidden="true">
          <use href="#i-close"></use>
        </svg>Limpar comparação</button>
    </div>
    <div class="standard-text hidden" id="textoSection">
      <h3>Minuta Padronizada para Decisão</h3>
      <p class="helper">Texto automático para copiar e colar na fundamentação sobre o enquadramento da parte autora no
        conceito de pessoa com deficiência para fins de BPC/LOAS.</p>
      <textarea id="textoPadrao" readonly></textarea>
      <div class="standard-text-actions">
        <span class="copy-feedback" id="copyFeedback"></span>
        <button class="btn btn-outline" id="btnCopiarTexto"><svg class="ui-icon sm" aria-hidden="true">
            <use href="#i-clipboard"></use>
          </svg>Copiar texto</button>
      </div>
    </div>
    <div class="comparison hidden" id="compSection">
      <h3>Comparação: Avaliação INSS × Reclassificação Judicial</h3>
      <div class="comp-grid">
        <div class="comp-card inss">
          <div class="comp-title">Avaliação INSS</div>
          <div class="comp-quals" id="compINSSq"></div>
          <div class="comp-result" id="compINSSr"></div>
        </div>
        <div class="comp-card pericia">
          <div class="comp-title">Reclassificação Judicial</div>
          <div class="comp-quals" id="compPERq"></div>
          <div class="comp-result" id="compPERr"></div>
        </div>
      </div>
      <div class="comp-change" id="compChange"></div>
    </div>
    <div class="judicial-control" id="judicialControlSection">
      <h3><svg class="ui-icon sm" aria-hidden="true">
          <use href="#i-balance"></use>
        </svg>Controle Judicial</h3>
      <p class="helper">Fluxo probatório para decidir se basta perícia médica judicial ou se também é necessária
        avaliação social.</p>
      <div class="jc-progress-wrap" id="jcProgressWrap">
        <div class="jc-progress-head">
          <span id="jcProgressLabel">Etapa 1 de 4 · Base administrativa</span>
          <span id="jcProgressPct">25%</span>
        </div>
        <div class="jc-progress-track">
          <div class="jc-progress-bar" id="jcProgressBar"></div>
        </div>
      </div>
      <div class="jc-why-blocked hidden" id="jcWhyBlocked"><svg class="ui-icon sm" aria-hidden="true">
          <use href="#i-alert"></use>
        </svg><span></span></div>
      <div class="jc-workflow">
        <section class="jc-step" id="stepAdmin">
          <div class="jc-step-header">
            <div class="jc-step-title"><span class="jc-step-index">1</span>Fixar avaliação administrativa (INSS)</div>
            <span class="jc-step-state pending" id="jcAdminState">Pendente</span>
          </div>
          <p class="jc-step-helper">Informe os qualificadores finais da fase administrativa e os reconhecimentos prévios
            do INSS para Funções do Corpo.</p>
          <p class="jc-step-note">O que fazer: escolha os 3 qualificadores finais administrativos, informe os
            reconhecimentos administrativos de Funções do Corpo e clique em <strong>Fixar base administrativa</strong>.
            Se necessário, use o atalho opcional para preencher os qualificadores a partir da Calculadora.</p>
          <div class="jc-step-guidance pending" id="jcAdminGuidance" role="status" aria-live="polite">
            <span class="jc-step-guidance-text" id="jcAdminGuidanceText">Pendências da etapa aparecerão aqui.</span>
          </div>
          <div class="jc-qual-grid">
            <div class="jc-qual-item">
              <div class="jc-field-title" id="jcAdminAmbLabel">Fatores Ambientais (final)</div>
              <div class="jc-q-buttons" id="jcAdminAmbButtons" role="group" aria-labelledby="jcAdminAmbLabel">
                <button class="jc-q-btn" data-value="0">N</button>
                <button class="jc-q-btn" data-value="1">L</button>
                <button class="jc-q-btn" data-value="2">M</button>
                <button class="jc-q-btn" data-value="3">G</button>
                <button class="jc-q-btn" data-value="4">C</button>
              </div>
            </div>
            <div class="jc-qual-item">
              <div class="jc-field-title" id="jcAdminAtivLabel">Atividades e Participação (final)</div>
              <div class="jc-q-buttons" id="jcAdminAtivButtons" role="group" aria-labelledby="jcAdminAtivLabel">
                <button class="jc-q-btn" data-value="0">N</button>
                <button class="jc-q-btn" data-value="1">L</button>
                <button class="jc-q-btn" data-value="2">M</button>
                <button class="jc-q-btn" data-value="3">G</button>
                <button class="jc-q-btn" data-value="4">C</button>
              </div>
            </div>
            <div class="jc-qual-item">
              <div class="jc-field-title" id="jcAdminCorpoLabel">Funções do Corpo (final)</div>
              <div class="jc-q-buttons" id="jcAdminCorpoButtons" role="group" aria-labelledby="jcAdminCorpoLabel">
                <button class="jc-q-btn" data-value="0">N</button>
                <button class="jc-q-btn" data-value="1">L</button>
                <button class="jc-q-btn" data-value="2">M</button>
                <button class="jc-q-btn" data-value="3">G</button>
                <button class="jc-q-btn" data-value="4">C</button>
              </div>
            </div>
          </div>
          <div class="jc-admin-rec-wrap">
            <div class="jc-field-title">Reconhecimentos administrativos do INSS (Funções do Corpo)</div>
            <p class="jc-field-helper">Essas respostas controlam os motivos permitidos na requalificação judicial de
              Funções do Corpo.</p>
            <div class="jc-social-grid">
              <div class="jc-social-item">
                <div class="jc-field-title" id="jcAdminEstruturasRecLabel">INSS reconheceu alterações em estruturas do corpo que configurem maiores
                  limitações ou restrições ao avaliado do que as alterações observadas em Funções do Corpo?</div>
                <div class="jc-segmented" id="jcAdminEstruturasRecButtons" role="group" aria-labelledby="jcAdminEstruturasRecLabel">
                  <button class="jc-seg-btn" data-value="sim">Sim</button>
                  <button class="jc-seg-btn" data-value="nao">Não</button>
                </div>
              </div>
              <div class="jc-social-item">
                <div class="jc-field-title" id="jcAdminProgRecLabel">INSS reconheceu prognóstico desfavorável?</div>
                <div class="jc-segmented" id="jcAdminProgRecButtons" role="group" aria-labelledby="jcAdminProgRecLabel">
                  <button class="jc-seg-btn" data-value="sim">Sim</button>
                  <button class="jc-seg-btn" data-value="nao">Não</button>
                </div>
              </div>
            </div>
            <details class="jc-help-details">
              <summary>Não sabe como responder? Ver explicação</summary>
              <div class="jc-help-grid">
                <article class="jc-help-item">
                  <div class="jc-help-title">Estruturas do corpo mais limitantes que Funções do Corpo</div>
                  <p>Este campo replica o critério da Portaria sobre existência de alterações em Estruturas do Corpo
                    que configurem maiores limitações ou restrições do que as observadas em Funções do Corpo.</p>
                  <p><strong>Marque “Sim”</strong> apenas quando esse reconhecimento constar no ato administrativo do
                    INSS.</p>
                  <p><strong>Marque “Não”</strong> quando não houver reconhecimento administrativo expresso desse
                    requisito.</p>
                  <p><strong>Base legal:</strong> Portaria Conjunta MDS/INSS nº 2/2015, Conceitos e Critérios (linhas
                    2848-2853 e 2890-2894).</p>
                </article>
                <article class="jc-help-item">
                  <div class="jc-help-title">Prognóstico desfavorável</div>
                  <p>Este campo replica o critério da Portaria sobre a condição de prognóstico desfavorável.</p>
                  <p><strong>Marque “Sim”</strong> apenas quando houver reconhecimento técnico expresso no material
                    administrativo do INSS.</p>
                  <p><strong>Marque “Não”</strong> quando esse reconhecimento não constar na avaliação
                    administrativa.</p>
                  <p><strong>Base legal:</strong> Portaria Conjunta MDS/INSS nº 2/2015, Conceitos e Critérios (linhas
                    2850-2853 e 2890-2893).</p>
                </article>
              </div>
            </details>
          </div>
          <details class="jc-autofill-details hidden" id="jcAutoFillDetails">
            <summary>Atalho opcional: preencher rascunho com a Calculadora</summary>
            <div class="jc-autofill-body">
              <p class="jc-autofill-hint" id="jcAutoFillHint"></p>
              <button class="btn jc-autofill-btn" id="btnUseCurrentAsBase"><svg class="ui-icon sm" aria-hidden="true">
                  <use href="#i-swap"></use>
                </svg>Preencher automaticamente com a Calculadora</button>
            </div>
          </details>
          <div class="jc-inline-note" id="jcAdminFixedSummary">Base administrativa ainda não fixada.</div>
          <div class="jc-actions-main">
            <button class="btn btn-gold jc-primary-btn" id="btnFixarBaseAdmin"><svg class="ui-icon sm"
                aria-hidden="true">
                <use href="#i-save"></use>
              </svg>Fixar base administrativa</button>
          </div>
        </section>

        <section class="jc-step" id="stepMed">
          <div class="jc-step-header">
            <div class="jc-step-title"><span class="jc-step-index">2</span>Informações da perícia médica judicial</div>
            <span class="jc-step-state blocked" id="jcMedState">Bloqueada</span>
          </div>
          <p class="jc-step-helper">Preencha os campos mínimos da perícia médica para liberar a triagem probatória.</p>
          <p class="jc-step-note">O que fazer: informe impedimento de longo prazo, decida se mantém Funções do Corpo
            administrativas e, se necessário, requalifique com motivo fechado.</p>
          <div class="jc-step-guidance blocked" id="jcMedGuidance" role="status" aria-live="polite">
            <span class="jc-step-guidance-text" id="jcMedGuidanceText">Etapa 2 bloqueada até fixar a base
              administrativa.</span>
          </div>
          <div class="jc-med-grid">
            <div class="jc-field">
              <div class="jc-field-title jc-field-title-with-help">
                <span id="jcImpedimentoLabel">Impedimento de longo prazo</span>
                <button type="button" class="sim-help-btn domain-help-btn jc-domain-help-btn"
                  data-help-key="concept.impedimento_lp" aria-label="Entender o conceito de impedimento de longo prazo"
                  aria-controls="simHelpPopover" aria-expanded="false">i</button>
              </div>
              <div class="jc-segmented" id="jcImpedimentoButtons" role="group" aria-labelledby="jcImpedimentoLabel">
                <button class="jc-seg-btn" data-value="sim">Sim</button>
                <button class="jc-seg-btn" data-value="nao">Não</button>
              </div>
            </div>
            <div class="jc-field jc-field-span-2">
              <div class="jc-field-title" id="jcCorpoKeepLabel">Funções do Corpo (judicial)</div>
              <div class="jc-segmented jc-segmented-wide" id="jcCorpoKeepButtons" role="group" aria-labelledby="jcCorpoKeepLabel">
                <button class="jc-seg-btn" data-value="sim">Manter qualificador administrativo</button>
                <button class="jc-seg-btn" data-value="nao">Alterar na fase judicial</button>
              </div>
              <p class="jc-field-helper">Se optar por alterar, escolha um motivo fechado. O sistema aplicará a regra
                correspondente para definir o qualificador judicial.</p>
              <div class="jc-ativ-mode-block hidden" id="jcCorpoChangeWrap">
                <label class="jc-field-title" for="jcCorpoReasonSelect">Motivo da alteração (seleção única)</label>
                <select id="jcCorpoReasonSelect" class="jc-select">
                  <option value="">Selecione o motivo</option>
                  <option value="estruturas">Estruturas do corpo mais graves (não reconhecidas pelo INSS)</option>
                  <option value="prognostico">Prognóstico desfavorável (não reconhecido pelo INSS)</option>
                  <option value="dominio_max">Domínio administrativo b1–b8 mais grave</option>
                  <option value="rebaixamento">Rebaixamento por prova superveniente</option>
                </select>
                <p class="jc-field-helper" id="jcCorpoReasonHint"></p>
                <div class="jc-ativ-mode-block hidden" id="jcCorpoDomainWrap">
                  <div class="jc-field-title">Pontuação administrativa dos domínios b1–b8</div>
                  <p class="jc-field-helper">Informe o(s) domínio(s) necessário(s). Para este motivo, vale o domínio
                    administrativo mais grave entre os informados.</p>
                  <div class="jc-complete-grid">
                    <div class="jc-complete-item">
                      <div class="jc-field-title jc-field-title-with-help"><span id="jcCorpoB1Label">b1 · Funções Mentais</span><button type="button" class="sim-help-btn domain-help-btn jc-domain-help-btn" data-help-key="domain.b1" aria-label="Entender b1 (Funções Mentais)" aria-controls="simHelpPopover" aria-expanded="false">i</button></div>
                      <div class="jc-q-buttons" id="jcCorpoB1Buttons" role="group" aria-labelledby="jcCorpoB1Label">
                        <button class="jc-q-btn" data-value="0">N</button>
                        <button class="jc-q-btn" data-value="1">L</button>
                        <button class="jc-q-btn" data-value="2">M</button>
                        <button class="jc-q-btn" data-value="3">G</button>
                        <button class="jc-q-btn" data-value="4">C</button>
                      </div>
                    </div>
                    <div class="jc-complete-item">
                      <div class="jc-field-title jc-field-title-with-help"><span id="jcCorpoB2Label">b2 · Funções Sensoriais</span><button type="button" class="sim-help-btn domain-help-btn jc-domain-help-btn" data-help-key="domain.b2" aria-label="Entender b2 (Funções Sensoriais)" aria-controls="simHelpPopover" aria-expanded="false">i</button></div>
                      <div class="jc-q-buttons" id="jcCorpoB2Buttons" role="group" aria-labelledby="jcCorpoB2Label">
                        <button class="jc-q-btn" data-value="0">N</button>
                        <button class="jc-q-btn" data-value="1">L</button>
                        <button class="jc-q-btn" data-value="2">M</button>
                        <button class="jc-q-btn" data-value="3">G</button>
                        <button class="jc-q-btn" data-value="4">C</button>
                      </div>
                    </div>
                    <div class="jc-complete-item">
                      <div class="jc-field-title jc-field-title-with-help"><span id="jcCorpoB3Label">b3 · Voz e Fala</span><button type="button" class="sim-help-btn domain-help-btn jc-domain-help-btn" data-help-key="domain.b3" aria-label="Entender b3 (Voz e Fala)" aria-controls="simHelpPopover" aria-expanded="false">i</button></div>
                      <div class="jc-q-buttons" id="jcCorpoB3Buttons" role="group" aria-labelledby="jcCorpoB3Label">
                        <button class="jc-q-btn" data-value="0">N</button>
                        <button class="jc-q-btn" data-value="1">L</button>
                        <button class="jc-q-btn" data-value="2">M</button>
                        <button class="jc-q-btn" data-value="3">G</button>
                        <button class="jc-q-btn" data-value="4">C</button>
                      </div>
                    </div>
                    <div class="jc-complete-item">
                      <div class="jc-field-title jc-field-title-with-help"><span id="jcCorpoB4Label">b4 · Cardio/Hemato/Imuno/Respiratório</span><button type="button" class="sim-help-btn domain-help-btn jc-domain-help-btn" data-help-key="domain.b4" aria-label="Entender b4 (Cardio/Hemato/Imuno/Respiratório)" aria-controls="simHelpPopover" aria-expanded="false">i</button></div>
                      <div class="jc-q-buttons" id="jcCorpoB4Buttons" role="group" aria-labelledby="jcCorpoB4Label">
                        <button class="jc-q-btn" data-value="0">N</button>
                        <button class="jc-q-btn" data-value="1">L</button>
                        <button class="jc-q-btn" data-value="2">M</button>
                        <button class="jc-q-btn" data-value="3">G</button>
                        <button class="jc-q-btn" data-value="4">C</button>
                      </div>
                    </div>
                    <div class="jc-complete-item">
                      <div class="jc-field-title jc-field-title-with-help"><span id="jcCorpoB5Label">b5 · Digestivo/Metabólico-Endócrino</span><button type="button" class="sim-help-btn domain-help-btn jc-domain-help-btn" data-help-key="domain.b5" aria-label="Entender b5 (Digestivo/Metabólico-Endócrino)" aria-controls="simHelpPopover" aria-expanded="false">i</button></div>
                      <div class="jc-q-buttons" id="jcCorpoB5Buttons" role="group" aria-labelledby="jcCorpoB5Label">
                        <button class="jc-q-btn" data-value="0">N</button>
                        <button class="jc-q-btn" data-value="1">L</button>
                        <button class="jc-q-btn" data-value="2">M</button>
                        <button class="jc-q-btn" data-value="3">G</button>
                        <button class="jc-q-btn" data-value="4">C</button>
                      </div>
                    </div>
                    <div class="jc-complete-item">
                      <div class="jc-field-title jc-field-title-with-help"><span id="jcCorpoB6Label">b6 · Geniturinário e Reprodutivo</span><button type="button" class="sim-help-btn domain-help-btn jc-domain-help-btn" data-help-key="domain.b6" aria-label="Entender b6 (Geniturinário e Reprodutivo)" aria-controls="simHelpPopover" aria-expanded="false">i</button></div>
                      <div class="jc-q-buttons" id="jcCorpoB6Buttons" role="group" aria-labelledby="jcCorpoB6Label">
                        <button class="jc-q-btn" data-value="0">N</button>
                        <button class="jc-q-btn" data-value="1">L</button>
                        <button class="jc-q-btn" data-value="2">M</button>
                        <button class="jc-q-btn" data-value="3">G</button>
                        <button class="jc-q-btn" data-value="4">C</button>
                      </div>
                    </div>
                    <div class="jc-complete-item">
                      <div class="jc-field-title jc-field-title-with-help"><span id="jcCorpoB7Label">b7 · Neuromusculoesquelético e Movimento</span><button type="button" class="sim-help-btn domain-help-btn jc-domain-help-btn" data-help-key="domain.b7" aria-label="Entender b7 (Neuromusculoesquelético e Movimento)" aria-controls="simHelpPopover" aria-expanded="false">i</button></div>
                      <div class="jc-q-buttons" id="jcCorpoB7Buttons" role="group" aria-labelledby="jcCorpoB7Label">
                        <button class="jc-q-btn" data-value="0">N</button>
                        <button class="jc-q-btn" data-value="1">L</button>
                        <button class="jc-q-btn" data-value="2">M</button>
                        <button class="jc-q-btn" data-value="3">G</button>
                        <button class="jc-q-btn" data-value="4">C</button>
                      </div>
                    </div>
                    <div class="jc-complete-item">
                      <div class="jc-field-title jc-field-title-with-help"><span id="jcCorpoB8Label">b8 · Pele e Estruturas Relacionadas</span><button type="button" class="sim-help-btn domain-help-btn jc-domain-help-btn" data-help-key="domain.b8" aria-label="Entender b8 (Pele e Estruturas Relacionadas)" aria-controls="simHelpPopover" aria-expanded="false">i</button></div>
                      <div class="jc-q-buttons" id="jcCorpoB8Buttons" role="group" aria-labelledby="jcCorpoB8Label">
                        <button class="jc-q-btn" data-value="0">N</button>
                        <button class="jc-q-btn" data-value="1">L</button>
                        <button class="jc-q-btn" data-value="2">M</button>
                        <button class="jc-q-btn" data-value="3">G</button>
                        <button class="jc-q-btn" data-value="4">C</button>
                      </div>
                    </div>
                  </div>
                </div>
                <div class="jc-ativ-mode-block hidden" id="jcCorpoManualWrap">
                  <div class="jc-field-title" id="jcCorpoManualLabel">Qualificador judicial manual (rebaixamento)</div>
                  <div class="jc-q-buttons" id="jcCorpoManualButtons" role="group" aria-labelledby="jcCorpoManualLabel">
                    <button class="jc-q-btn" data-value="0">N</button>
                    <button class="jc-q-btn" data-value="1">L</button>
                    <button class="jc-q-btn" data-value="2">M</button>
                    <button class="jc-q-btn" data-value="3">G</button>
                    <button class="jc-q-btn" data-value="4">C</button>
                  </div>
                </div>
                <div class="jc-reduction-alert hidden" id="jcCorpoReductionAlert">
                  <strong>Atenção:</strong> o qualificador judicial ficou inferior ao administrativo. Confirme para
                  prosseguir.
                  <label><input type="checkbox" id="jcCorpoReductionConfirm"> Confirmo a redução com base na prova
                    superveniente</label>
                </div>
              </div>
              <div class="jc-inline-note" id="jcCorpoResultSummary">Resultado de Funções do Corpo aguardando definição.
              </div>
            </div>
            <div class="jc-field" id="jcHasAtivMedField">
              <div class="jc-field-title" id="jcHasAtivMedLabel">Perícia médica trouxe elementos para requalificar Atividades e Participação?
              </div>
              <div class="jc-segmented" id="jcHasAtivMedButtons" role="group" aria-labelledby="jcHasAtivMedLabel">
                <button class="jc-seg-btn" data-value="sim">Sim</button>
                <button class="jc-seg-btn" data-value="nao">Não</button>
              </div>
              <p class="jc-field-helper" id="jcHasAtivMedHint">Se “Sim”, escolha o modo de requalificação abaixo.</p>
            </div>
            <div class="jc-inline-note hidden" id="jcAtivNotApplicableNote"></div>
            <div class="jc-field hidden" id="jcAtivMedWrap">
              <div class="jc-field-title" id="jcAtivModeLabel">Modo de requalificação de Atividades e Participação (médico judicial)</div>
              <div class="jc-segmented" id="jcAtivModeButtons" role="group" aria-labelledby="jcAtivModeLabel">
                <button class="jc-seg-btn" data-value="simples">Simples</button>
                <button class="jc-seg-btn" data-value="completa">Completa (d1–d9)</button>
              </div>
              <p class="jc-field-helper">No modo simples, informe apenas o qualificador final de Atividades e
                Participação com justificativa. No modo completo, informe d1–d9 e o sistema calcula o final pela fórmula
                normativa.</p>
              <div class="jc-ativ-mode-block hidden" id="jcAtivModeSimpleWrap">
                <div class="jc-field-title" id="jcAtivMedSimpleLabel">Atividades e Participação (final, modo simples)</div>
                <div class="jc-q-buttons" id="jcAtivMedSimpleButtons" role="group" aria-labelledby="jcAtivMedSimpleLabel">
                  <button class="jc-q-btn" data-value="0">N</button>
                  <button class="jc-q-btn" data-value="1">L</button>
                  <button class="jc-q-btn" data-value="2">M</button>
                  <button class="jc-q-btn" data-value="3">G</button>
                  <button class="jc-q-btn" data-value="4">C</button>
                </div>
                <label class="jc-field-title jc-field-title-margin" for="jcAtivMedJustification">Justificativa médica
                  (obrigatória no modo simples)</label>
                <textarea id="jcAtivMedJustification" class="jc-mini-textarea"
                  placeholder="Descreva, de forma objetiva, o fundamento técnico para o qualificador final de Atividades e Participação."></textarea>
              </div>
              <div class="jc-ativ-mode-block hidden" id="jcAtivModeCompleteWrap">
                <div class="jc-field-title">Domínios d1–d9 (modo completo)</div>
                <p class="jc-field-helper">Preencha todos os domínios para calcular automaticamente o qualificador final
                  de Atividades e Participação.</p>
                <div class="jc-complete-grid">
                  <div class="jc-complete-item">
                    <div class="jc-field-title jc-field-title-with-help"><span id="jcAtivD1Label">d1 · Aprendizagem</span><button type="button" class="sim-help-btn domain-help-btn jc-domain-help-btn" data-help-key="domain.d1" aria-label="Entender d1 (Aprendizagem)" aria-controls="simHelpPopover" aria-expanded="false">i</button></div>
                    <div class="jc-q-buttons" id="jcAtivD1Buttons" role="group" aria-labelledby="jcAtivD1Label">
                      <button class="jc-q-btn" data-value="0">N</button>
                      <button class="jc-q-btn" data-value="1">L</button>
                      <button class="jc-q-btn" data-value="2">M</button>
                      <button class="jc-q-btn" data-value="3">G</button>
                      <button class="jc-q-btn" data-value="4">C</button>
                    </div>
                  </div>
                  <div class="jc-complete-item">
                    <div class="jc-field-title jc-field-title-with-help"><span id="jcAtivD2Label">d2 · Tarefas Gerais</span><button type="button" class="sim-help-btn domain-help-btn jc-domain-help-btn" data-help-key="domain.d2" aria-label="Entender d2 (Tarefas Gerais)" aria-controls="simHelpPopover" aria-expanded="false">i</button></div>
                    <div class="jc-q-buttons" id="jcAtivD2Buttons" role="group" aria-labelledby="jcAtivD2Label">
                      <button class="jc-q-btn" data-value="0">N</button>
                      <button class="jc-q-btn" data-value="1">L</button>
                      <button class="jc-q-btn" data-value="2">M</button>
                      <button class="jc-q-btn" data-value="3">G</button>
                      <button class="jc-q-btn" data-value="4">C</button>
                    </div>
                  </div>
                  <div class="jc-complete-item">
                    <div class="jc-field-title jc-field-title-with-help"><span id="jcAtivD3Label">d3 · Comunicação</span><button type="button" class="sim-help-btn domain-help-btn jc-domain-help-btn" data-help-key="domain.d3" aria-label="Entender d3 (Comunicação)" aria-controls="simHelpPopover" aria-expanded="false">i</button></div>
                    <div class="jc-q-buttons" id="jcAtivD3Buttons" role="group" aria-labelledby="jcAtivD3Label">
                      <button class="jc-q-btn" data-value="0">N</button>
                      <button class="jc-q-btn" data-value="1">L</button>
                      <button class="jc-q-btn" data-value="2">M</button>
                      <button class="jc-q-btn" data-value="3">G</button>
                      <button class="jc-q-btn" data-value="4">C</button>
                    </div>
                  </div>
                  <div class="jc-complete-item">
                    <div class="jc-field-title jc-field-title-with-help"><span id="jcAtivD4Label">d4 · Mobilidade</span><button type="button" class="sim-help-btn domain-help-btn jc-domain-help-btn" data-help-key="domain.d4" aria-label="Entender d4 (Mobilidade)" aria-controls="simHelpPopover" aria-expanded="false">i</button></div>
                    <div class="jc-q-buttons" id="jcAtivD4Buttons" role="group" aria-labelledby="jcAtivD4Label">
                      <button class="jc-q-btn" data-value="0">N</button>
                      <button class="jc-q-btn" data-value="1">L</button>
                      <button class="jc-q-btn" data-value="2">M</button>
                      <button class="jc-q-btn" data-value="3">G</button>
                      <button class="jc-q-btn" data-value="4">C</button>
                    </div>
                  </div>
                  <div class="jc-complete-item">
                    <div class="jc-field-title jc-field-title-with-help"><span id="jcAtivD5Label">d5 · Cuidado Pessoal</span><button type="button" class="sim-help-btn domain-help-btn jc-domain-help-btn" data-help-key="domain.d5" aria-label="Entender d5 (Cuidado Pessoal)" aria-controls="simHelpPopover" aria-expanded="false">i</button></div>
                    <div class="jc-q-buttons" id="jcAtivD5Buttons" role="group" aria-labelledby="jcAtivD5Label">
                      <button class="jc-q-btn" data-value="0">N</button>
                      <button class="jc-q-btn" data-value="1">L</button>
                      <button class="jc-q-btn" data-value="2">M</button>
                      <button class="jc-q-btn" data-value="3">G</button>
                      <button class="jc-q-btn" data-value="4">C</button>
                    </div>
                  </div>
                  <div class="jc-complete-item">
                    <div class="jc-field-title jc-field-title-with-help"><span id="jcAtivD6Label">d6 · Vida Doméstica</span><button type="button" class="sim-help-btn domain-help-btn jc-domain-help-btn" data-help-key="domain.d6" aria-label="Entender d6 (Vida Doméstica)" aria-controls="simHelpPopover" aria-expanded="false">i</button></div>
                    <div class="jc-q-buttons" id="jcAtivD6Buttons" role="group" aria-labelledby="jcAtivD6Label">
                      <button class="jc-q-btn" data-value="0">N</button>
                      <button class="jc-q-btn" data-value="1">L</button>
                      <button class="jc-q-btn" data-value="2">M</button>
                      <button class="jc-q-btn" data-value="3">G</button>
                      <button class="jc-q-btn" data-value="4">C</button>
                    </div>
                  </div>
                  <div class="jc-complete-item">
                    <div class="jc-field-title jc-field-title-with-help"><span id="jcAtivD7Label">d7 · Relações Interpessoais</span><button type="button" class="sim-help-btn domain-help-btn jc-domain-help-btn" data-help-key="domain.d7" aria-label="Entender d7 (Relações Interpessoais)" aria-controls="simHelpPopover" aria-expanded="false">i</button></div>
                    <div class="jc-q-buttons" id="jcAtivD7Buttons" role="group" aria-labelledby="jcAtivD7Label">
                      <button class="jc-q-btn" data-value="0">N</button>
                      <button class="jc-q-btn" data-value="1">L</button>
                      <button class="jc-q-btn" data-value="2">M</button>
                      <button class="jc-q-btn" data-value="3">G</button>
                      <button class="jc-q-btn" data-value="4">C</button>
                    </div>
                  </div>
                  <div class="jc-complete-item">
                    <div class="jc-field-title jc-field-title-with-help"><span id="jcAtivD8Label">d8 · Áreas Principais da Vida</span><button type="button" class="sim-help-btn domain-help-btn jc-domain-help-btn" data-help-key="domain.d8" aria-label="Entender d8 (Áreas Principais da Vida)" aria-controls="simHelpPopover" aria-expanded="false">i</button></div>
                    <div class="jc-q-buttons" id="jcAtivD8Buttons" role="group" aria-labelledby="jcAtivD8Label">
                      <button class="jc-q-btn" data-value="0">N</button>
                      <button class="jc-q-btn" data-value="1">L</button>
                      <button class="jc-q-btn" data-value="2">M</button>
                      <button class="jc-q-btn" data-value="3">G</button>
                      <button class="jc-q-btn" data-value="4">C</button>
                    </div>
                  </div>
                  <div class="jc-complete-item">
                    <div class="jc-field-title jc-field-title-with-help"><span id="jcAtivD9Label">d9 · Vida Comunitária</span><button type="button" class="sim-help-btn domain-help-btn jc-domain-help-btn" data-help-key="domain.d9" aria-label="Entender d9 (Vida Comunitária)" aria-controls="simHelpPopover" aria-expanded="false">i</button></div>
                    <div class="jc-q-buttons" id="jcAtivD9Buttons" role="group" aria-labelledby="jcAtivD9Label">
                      <button class="jc-q-btn" data-value="0">N</button>
                      <button class="jc-q-btn" data-value="1">L</button>
                      <button class="jc-q-btn" data-value="2">M</button>
                      <button class="jc-q-btn" data-value="3">G</button>
                      <button class="jc-q-btn" data-value="4">C</button>
                    </div>
                  </div>
                </div>
                <div class="jc-inline-note" id="jcAtivComputedSummary">Preencha d1–d9 para calcular o qualificador final
                  de Atividades e Participação.</div>
              </div>
            </div>
          </div>
        </section>

        <section class="jc-step" id="stepTriagem">
          <div class="jc-step-header">
            <div class="jc-step-title"><span class="jc-step-index">3</span>Triagem probatória</div>
            <span class="jc-step-state pending" id="jcTriagemState">Pendente</span>
          </div>
          <p class="jc-step-note">O que isso mostra: resultado das verificações probatórias e a razão objetiva para
            dispensar ou exigir avaliação social.</p>
          <div class="jc-step-guidance pending" id="jcTriagemGuidance" role="status" aria-live="polite">
            <span class="jc-step-guidance-text" id="jcTriagemGuidanceText">Conclua as etapas anteriores para liberar a
              triagem.</span>
          </div>
          <div class="jc-status-badge pending" id="jcStatusBadge">Preencha as etapas 1 e 2 para liberar a conclusão
            probatória.</div>
          <div class="jc-trace" id="jcTrace"></div>
        </section>

        <section class="jc-step" id="stepTexto">
          <div class="jc-step-header">
            <div class="jc-step-title"><span class="jc-step-index">4</span>Texto para decisão</div>
            <span class="jc-step-state blocked" id="jcTextoState">Aguardando triagem</span>
          </div>
          <p class="jc-step-helper">Gere texto padronizado com a trilha de raciocínio da triagem para colar na decisão.
          </p>
          <p class="jc-step-note">O que fazer: gere e copie a minuta apenas após a triagem estar concluída.</p>
          <div class="jc-step-guidance blocked" id="jcTextoGuidance" role="status" aria-live="polite">
            <span class="jc-step-guidance-text" id="jcTextoGuidanceText">A minuta será liberada após a triagem.</span>
          </div>
          <div class="standard-text-actions">
            <span class="copy-feedback" id="copyFeedbackControle"></span>
            <button class="btn btn-outline" id="btnGerarControleTexto"><svg class="ui-icon sm" aria-hidden="true">
                <use href="#i-document"></use>
              </svg>Gerar texto</button>
            <button class="btn btn-gold" id="btnGerarCopiarControleTexto"><svg class="ui-icon sm" aria-hidden="true">
                <use href="#i-clipboard"></use>
              </svg>Gerar e copiar texto da decisão</button>
            <button class="btn btn-outline" id="btnCopiarControleTexto"><svg class="ui-icon sm" aria-hidden="true">
                <use href="#i-clipboard"></use>
              </svg>Somente copiar</button>
            <button class="btn btn-red" id="btnLimparControleJudicial"><svg class="ui-icon sm" aria-hidden="true">
                <use href="#i-close"></use>
              </svg>Limpar controle judicial</button>
          </div>
          <textarea id="textoControleJudicial" class="jc-textarea" readonly></textarea>
        </section>
      </div>
    </div>

    <footer>
      <p>Base normativa:
        <a class="footer-norm-link" id="footerPortariaPdfLink" href="docs/normas/portaria-conjunta-2-2015.pdf"
          target="_blank" rel="noopener noreferrer"
          title="Abrir o PDF da Portaria Conjunta MDS/INSS nº 2/2015 em nova aba"><svg class="ui-icon sm"
            aria-hidden="true">
            <use href="#i-document"></use>
          </svg>Portaria Conjunta MDS/INSS nº 2/2015 (PDF)</a>
        · Portaria MDS/INSS nº 34/2025 (Art. 13, §7º)
        <button type="button" class="footer-text-link" id="openPortariaTextBtn"
          title="Abrir a versão em texto dentro desta página">Ler versão texto na aplicação</button>
      </p>
      <p>Resolução CNJ nº 630/2025 (Sisperjud) · 2ª Turma Recursal — SJRJ | Gabinete 3</p>
    </footer>

    <dialog class="portaria-modal" id="portariaModal" aria-labelledby="portariaModalTitle">
      <article class="portaria-modal-card">
        <header class="portaria-modal-header">
          <h2 id="portariaModalTitle">Portaria Conjunta MDS/INSS nº 2/2015</h2>
          <button class="btn btn-red portaria-close-btn" id="closePortariaModalBtn" type="button"
            data-portaria-close><svg class="ui-icon sm" aria-hidden="true">
              <use href="#i-close"></use>
            </svg>Fechar</button>
        </header>
        <p class="portaria-modal-helper">Texto integral para consulta rápida. O PDF oficial pode ser aberto no botão
          abaixo.</p>
        <div class="portaria-modal-status" id="portariaStatus" role="status" aria-live="polite"></div>
        <pre class="portaria-modal-content" id="portariaContent"></pre>
        <div class="portaria-modal-actions">
          <a class="btn btn-outline" id="portariaPdfLink" href="docs/normas/portaria-conjunta-2-2015.pdf"
            target="_blank" rel="noopener noreferrer"><svg class="ui-icon sm" aria-hidden="true">
              <use href="#i-document"></use>
            </svg>Abrir PDF oficial</a>
          <button class="btn btn-gold" type="button" data-portaria-close><svg class="ui-icon sm" aria-hidden="true">
              <use href="#i-close"></use>
            </svg>Fechar leitura</button>
        </div>
      </article>
    </dialog>

    <dialog class="portaria-modal padrao-modal" id="padraoModal" aria-labelledby="padraoModalTitle">
      <article class="portaria-modal-card padrao-modal-card">
        <header class="portaria-modal-header">
          <h2 id="padraoModalTitle">Aplicar padrão médio</h2>
          <button class="btn btn-red portaria-close-btn" id="closePadraoModalBtn" type="button" data-padrao-close><svg
              class="ui-icon sm" aria-hidden="true">
              <use href="#i-close"></use>
            </svg>Cancelar</button>
        </header>
        <p class="portaria-modal-helper" id="padraoModalMessage"></p>
        <div class="padrao-modal-summary" id="padraoModalSummary"></div>
        <div class="padrao-modal-actions">
          <button class="btn btn-outline" type="button" id="padraoPreserveBtn"><svg class="ui-icon sm"
              aria-hidden="true">
              <use href="#i-check-circle"></use>
            </svg>Preservar preenchidos</button>
          <button class="btn btn-gold" type="button" id="padraoOverwriteBtn"><svg class="ui-icon sm"
              aria-hidden="true">
              <use href="#i-swap"></use>
            </svg>Sobrescrever preenchidos</button>
        </div>
      </article>
    </dialog>

    <div class="sim-help-popover hidden" id="simHelpPopover" role="dialog" aria-modal="false" aria-hidden="true"
      aria-labelledby="simHelpTitle" tabindex="-1">
      <div class="sim-help-popover-header">
        <h4 id="simHelpTitle"></h4>
        <button type="button" class="sim-help-close" id="simHelpCloseBtn" aria-label="Fechar ajuda"><svg
            class="ui-icon sm" aria-hidden="true">
            <use href="#i-close"></use>
          </svg></button>
      </div>
      <p class="sim-help-summary" id="simHelpSummary"></p>
      <ul class="sim-help-list" id="simHelpList"></ul>
      <p class="sim-help-source" id="simHelpSource"></p>
      <p class="sim-help-excerpt hidden" id="simHelpExcerpt"></p>
      <div class="sim-help-actions">
        <button type="button" class="sim-help-link" id="simHelpExcerptBtn">Ver base legal (trecho)</button>
        <button type="button" class="sim-help-link" id="simHelpPortariaBtn">Ver Portaria completa</button>
      </div>
    </div>
  </div>

  <script>
    (function loadAppScript() {
      if (window.location.protocol === 'file:') {
        const warning = document.createElement('div');
        warning.setAttribute('role', 'alert');
        warning.style.cssText = [
          'position:fixed',
          'top:0',
          'left:0',
          'right:0',
          'z-index:9999',
          'padding:12px 16px',
          'background:#7a1f1f',
          'color:#fff',
          'font:600 14px/1.4 \"Source Sans 3\", sans-serif',
          'box-shadow:0 2px 8px rgba(0,0,0,.25)'
        ].join(';');
        warning.textContent = 'Esta aplicação usa módulos ES e não funciona via file://. Execute \"npm run start\" e acesse http://127.0.0.1:8000/index.html.';
        document.body.prepend(warning);
        return;
      }

      const script = document.createElement('script');
      script.type = 'module';
      script.src = 'src/js/main.js';
      document.body.appendChild(script);
    })();
  </script>
</body>

</html>
